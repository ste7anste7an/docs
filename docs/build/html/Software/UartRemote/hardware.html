<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hardware &mdash; Anton&#39;s Mindstorms Docs  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Anton's Mindstorms Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Software documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Hardware/index.html">Hardware documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Anton's Mindstorms Docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Hardware</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Software/UartRemote/hardware.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="hardware">
<span id="id1"></span><h1>Hardware<a class="headerlink" href="#hardware" title="Permalink to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>In the picture below an overviwe of the hardware components of the LMS-ESP32 board is given.</p>
<a class="reference internal image-reference" href="../../_images/lmsesp32_hardware_overview1.jpg"><img alt="Hardware Overview" src="../../_images/lmsesp32_hardware_overview1.jpg" style="width: 1000px;" /></a>
<p>In the photo shown above, the major components and headers are shown. Below we briefly discuss each of these:</p>
<ul>
<li><p>ESP32-WROVER</p>
<p>This is the microcontroller we use on the board. It is an Esspressif dual core MCU whith the following specifications.
- dual 240MHZ core
- 520kB SRAM
- 4MByte flash memory
- 4Mbyte PS-RAM</p>
</li>
<li><p>power LED</p>
<p>This LED is connected to the 3.3V power ad will light up when the board is powered.</p>
</li>
<li><p>micro USB connector</p>
<p>Used for connecting the board through the build-in usb-uart convertor and for powering the board with 5V</p>
</li>
<li><p>GPIO power header</p>
<p>This is the header where you connect your hardware such as servo motors , displays and sensors. There are 5V and 3.3V power pins present on the header</p>
</li>
<li><p>Groves I2C header</p>
<p>This is a grove’s connector that can be used to connect I2C devices to the board. The connector uses 3.3V power supply.</p>
</li>
<li><p>I2S microphone</p>
<p>We provide two 3-pin headers for connecting an <cite>INMP441 MEMS microphone</cite>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Microphone is connected using the GPIO pins 27,32 and 33. These Pins are also present on the GPIO header.</p>
</div>
</li>
<li><p>Lego robot connector
This connector is used to connect the board to your Lego robot. It connects to the 3.3V power, the UART pins and the M+ pin of the robot.</p></li>
<li><p>Reset button
This button is connected to the reset signal of the ESP32</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The pinout and maping on ESP32 GPIO pins can be found in the <a class="reference internal" href="pinout.html#pinout"><span class="std std-ref">Pinout</span></a>.</p>
</div>
</section>
<section id="usb-connector">
<h2>USB connector<a class="headerlink" href="#usb-connector" title="Permalink to this heading"></a></h2>
<p>We provide a micro USB connector for  powering the board and for communicating with UART0 of the ESP32 using a CH340 Uart USB transceiver. The additional circuit with the two transistors Q3 and Q4 allows the programming tool to switch the ESP32 in program mode using the EN and IO0 pins.</p>
<a class="reference internal image-reference" href="../../_images/schematic_lmsesp32_usb1.jpg"><img alt="USB Schematic" src="../../_images/schematic_lmsesp32_usb1.jpg" style="width: 1000px;" /></a>
</section>
<section id="power-supply-of-the-board">
<h2>Power supply of the board<a class="headerlink" href="#power-supply-of-the-board" title="Permalink to this heading"></a></h2>
<p>When connected to the Lego robot, the board is powered from the robot’s 3.3V power supply. When the board is connected to the USB port of a PC, it will get 5V power from the USB port. The 5V is fed to an LMS1117 power regulator with a 3.3V output used for powering the ESP32.</p>
<p>When the robot and the USB port are both connected simultaneously, the 3.3V rail will get its power from both the Lego robot as well as from the output of the LMS1117. Because there is only a small difference in these two voltages, there will be no harm done to the board or the lego robot.</p>
<a class="reference internal image-reference" href="../../_images/schematic_lmsesp32_power1.jpg"><img alt="Hardware Overview" src="../../_images/schematic_lmsesp32_power1.jpg" style="width: 1000px;" /></a>
<p>For applications that need 5V, such as LED strips or servo motors, we provide 5V outputs on the 14x2 header. This 5V is drawn from hte USB connector when that is connected. For obtaining a stable 5V when the board is only connected to the lego robot, we provide a buck converter that can be added on the board. This buck converts the voltage supplied from the lego robot motor output (which is 8V when the motor power is set to 100%) to 5V in a very efficient way. When powering the board from the robot motor output simultaneously with the USB power, we get two 5V sources: one from the USB connector and one from the output of the buck converter. We estimate the because the voltages are almost the same, no harm willl be done to the board, the lego robot or the USB port.</p>
</section>
<section id="gpio-header">
<h2>GPIO header<a class="headerlink" href="#gpio-header" title="Permalink to this heading"></a></h2>
<p>The GPIO header provides access to 14 GPIO pins of the ESP32 and provides a number of 5V and 3.3V power pins.</p>
<a class="reference internal image-reference" href="../../_images/schematic_lmsesp32_gpio_2x141.jpg"><img alt="GPIO header" src="../../_images/schematic_lmsesp32_gpio_2x141.jpg" style="width: 1000px;" /></a>
<p>Whe grouped the pins in 3 different regions. The yellow region for connecting servo’s or LED strips pwered with 5V (keep in mind that all the logic pins of the ESP32 are only 3.3V tollerant), the red region for power connections and the green region for access to the GPIO pins.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The GPIO Pins are directly connected to the ESP32 and are not 5V tollerant, so use only 3.3V logic signals.</p>
</div>
</section>
<section id="i2c-grove-connector">
<h2>I2C Grove connector<a class="headerlink" href="#i2c-grove-connector" title="Permalink to this heading"></a></h2>
<p>We use the standard Grove connector that is used on many i2c sensors. M5Stack Units use them and can directly be connected to the board. Note that the power supply on this port is 3.3V.</p>
<a class="reference internal image-reference" href="../../_images/schematic_lmsesp32_grove_i2c1.jpg"><img alt="Grove i2c interface" src="../../_images/schematic_lmsesp32_grove_i2c1.jpg" style="width: 1000px;" /></a>
</section>
<section id="i2s-microphone">
<h2>I2S Microphone<a class="headerlink" href="#i2s-microphone" title="Permalink to this heading"></a></h2>
<p>We provide two headers for connecting an INMP441 I2S microphone to the board. The esp-idf (Espressif IoT Development Framework) supports natevely the usage of I2S audio devices.</p>
<a class="reference internal image-reference" href="../../_images/MEMS_microphone1.jpg"><img alt="INMP441 MEMS microphone" src="../../_images/MEMS_microphone1.jpg" style="width: 1000px;" /></a>
<p>The I2S connections use GPIO 27, 32 and 33 for word clock line (I2S_WS), the data line (I2S_SD) and the bit clock line (I2S_SCK). Note that this microphone is a PCM version.</p>
<a class="reference internal image-reference" href="../../_images/schematic_lmsesp32_I2S_MIC1.jpg"><img alt="Schematic for the I2S microphone connection" src="../../_images/schematic_lmsesp32_I2S_MIC1.jpg" style="width: 1000px;" /></a>
<p>The solder pads on the back of the board can be used to select in which channel the digital output of the microphone is collected. By default the pad for selecting the left channel is shorted. Should you need to change the channel, than the trace between the MIC-L pads should be removed and the pads MIC-R should be shorted. Take care not to short both pads at the same time, as that leads to a power shortage.</p>
<a class="reference internal image-reference" href="../../_images/select_LR_I2S1.jpg"><img alt="Solder pads for L/R signal of microphone" src="../../_images/select_LR_I2S1.jpg" style="width: 1000px;" /></a>
</section>
<section id="buck-converter">
<h2>Buck converter<a class="headerlink" href="#buck-converter" title="Permalink to this heading"></a></h2>
<p>We provide solder pads for a MP1584 buck converter. The buck converters input is connected to the M+ pin of the Lego robot’s motor interface. When seeting the Lego motor to 100% power, the M+ pin will provide 8V DC. The buck converter brings this voltage down to a well regulated 5V DC.</p>
<a class="reference internal image-reference" href="../../_images/buck1.jpg"><img alt="MP1584 buck converter with 5V output" src="../../_images/buck1.jpg" style="width: 1000px;" /></a>
<p>The following code can be executed on the SPIKE Prime or Robot Inventor hub. Here we use Port A to connect the LMS-ESP32:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hub</span>
<span class="c1"># set motor power to +100%, resulting in 8V on M+ and 0V on M-</span>
<span class="n">hub</span><span class="o">.</span><span class="n">port</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">pwm</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Anton, Ste7an.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>